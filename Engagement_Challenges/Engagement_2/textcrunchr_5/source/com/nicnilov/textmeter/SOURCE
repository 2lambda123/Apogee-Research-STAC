This code was found open source at https://github.com/nicnilov/textmeter
