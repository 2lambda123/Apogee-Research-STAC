package com.ainfosec.MalwareAnalyzer;

/**
 * Wrapper class for storing cosine similarity results.
 * Implements Comparable so that collections containing this type may be sorted.
 * ComparisonResult objects are always generated with respect to some Sample that is
 * expected to be known to the instantiator.
 */
public class ComparisonResult implements Comparable<ComparisonResult>
{
	// Cosine similarity score
	private final double score;
	
	// MD5 digest of the malware sample in the database against which score was computed
	private final String md5;

	/**
	 * Constructor
	 * @param _score Cosine similarity score
	 * @param _md5 MD5 digest of the malware sample in the database against which score was computed
	 */
	public ComparisonResult(double _score, String _md5)
	{
		score = _score;
		md5 = _md5;
	}

	/**
	 * Getter for cosine similarity score
	 * @return score
	 */
	public double get_score()
	{
		return score;
	}

	/**
	 * Getter for MD5 digest of the malware sample in the database against which score was computed
	 * @return MD5 digest
	 */
	public String get_md5()
	{
		return md5;
	}
	
	/* (non-Javadoc)
	 * @see java.lang.Comparable#compareTo(java.lang.Object)
	 */
	public int compareTo(ComparisonResult cr)
	{
		if(this.score == cr.get_score())
		{
			return 0;
		}
		return this.score > cr.get_score() ? 1 : -1;
	}
}
